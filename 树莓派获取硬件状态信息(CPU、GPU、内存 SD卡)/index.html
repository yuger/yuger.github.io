<html>
<head>
	
	<title>树莓派获取硬件状态信息(CPU、GPU、内存 SD卡)</title>
	<meta name="keywords" content="My Blog, Spider Bitch!" />

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    
    <!--<link rel="stylesheet" href="/css/main.css">-->
	<link href="/css/main.css?v=2" rel="stylesheet" type="text/css" />
    <!--<link rel="stylesheet" href="/css/style.css">-->
    

    <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Atom feed">

    
	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2"/>
    

</head>

<body>

<p>玩树莓派时比较关心的就是它的内存够不够用，它的系统资源占用情况怎么样，通过以下Python脚本，我们可以直接读取标题中所列出的相关参数，代码不长，它们依然运行在我的树莓派里面。</p>
<p>建立python脚本文件,文件名就叫做get.py吧：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo nano get.py</div></pre></td></tr></table></figure></p>
<p>贴入以下代码：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> commands</div><div class="line"></div><div class="line"><span class="comment"># Return CPU temperature as a character string                                     </span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getCPUtemperature</span><span class="params">()</span>:</span></div><div class="line">    res = os.popen(<span class="string">'vcgencmd measure_temp'</span>).readline()</div><div class="line">    <span class="keyword">return</span>(res.replace(<span class="string">"temp="</span>,<span class="string">""</span>).replace(<span class="string">"'C\n"</span>,<span class="string">""</span>))</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_gpu_temp</span><span class="params">()</span>:</span></div><div class="line">    gpu_temp = commands.getoutput( <span class="string">'/opt/vc/bin/vcgencmd measure_temp'</span>).replace( <span class="string">'temp='</span>, <span class="string">''</span>).replace( <span class="string">'\'C'</span>, <span class="string">''</span>)</div><div class="line">    <span class="keyword">return</span>  float(gpu_temp)</div><div class="line"></div><div class="line"><span class="comment"># Return RAM information (unit=kb) in a list                                      </span></div><div class="line"><span class="comment"># Index 0: total RAM                                                              </span></div><div class="line"><span class="comment"># Index 1: used RAM                                                                </span></div><div class="line"><span class="comment"># Index 2: free RAM                                                                </span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getRAMinfo</span><span class="params">()</span>:</span></div><div class="line">    p = os.popen(<span class="string">'free'</span>)</div><div class="line">    i = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> <span class="number">1</span>:</div><div class="line">        i = i + <span class="number">1</span></div><div class="line">        line = p.readline()</div><div class="line">        <span class="keyword">if</span> i==<span class="number">2</span>:</div><div class="line">            <span class="keyword">return</span>(line.split()[<span class="number">1</span>:<span class="number">4</span>])</div><div class="line"> </div><div class="line"><span class="comment"># Return % of CPU used by user as a character string                               </span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getCPUuse</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span>(str(os.popen(<span class="string">"top -n1 | awk '/Cpu\(s\):/ &#123;print $2&#125;'"</span>).readline().strip()))</div><div class="line"> </div><div class="line"><span class="comment"># Return information about disk space as a list (unit included)                    </span></div><div class="line"><span class="comment"># Index 0: total disk space                                                        </span></div><div class="line"><span class="comment"># Index 1: used disk space                                                        </span></div><div class="line"><span class="comment"># Index 2: remaining disk space                                                    </span></div><div class="line"><span class="comment"># Index 3: percentage of disk used                                                 </span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getDiskSpace</span><span class="params">()</span>:</span></div><div class="line">    p = os.popen(<span class="string">"df -h /"</span>)</div><div class="line">    i = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> <span class="number">1</span>:</div><div class="line">        i = i +<span class="number">1</span></div><div class="line">        line = p.readline()</div><div class="line">        <span class="keyword">if</span> i==<span class="number">2</span>:</div><div class="line">            <span class="keyword">return</span>(line.split()[<span class="number">1</span>:<span class="number">5</span>])</div><div class="line"> </div><div class="line"><span class="comment"># CPU informatiom</span></div><div class="line">CPU_temp = getCPUtemperature()</div><div class="line">CPU_usage = getCPUuse()</div><div class="line"> </div><div class="line"><span class="comment"># RAM information</span></div><div class="line"><span class="comment"># Output is in kb, here I convert it in Mb for readability</span></div><div class="line">RAM_stats = getRAMinfo()</div><div class="line">RAM_total = round(int(RAM_stats[<span class="number">0</span>]) / <span class="number">1000</span>,<span class="number">1</span>)</div><div class="line">RAM_used = round(int(RAM_stats[<span class="number">1</span>]) / <span class="number">1000</span>,<span class="number">1</span>)</div><div class="line">RAM_free = round(int(RAM_stats[<span class="number">2</span>]) / <span class="number">1000</span>,<span class="number">1</span>)</div><div class="line"> </div><div class="line"><span class="comment"># Disk information</span></div><div class="line">DISK_stats = getDiskSpace()</div><div class="line">DISK_total = DISK_stats[<span class="number">0</span>]</div><div class="line">DISK_used = DISK_stats[<span class="number">1</span>]</div><div class="line">DISK_perc = DISK_stats[<span class="number">3</span>]</div><div class="line"> </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    print(<span class="string">''</span>)</div><div class="line">    print(<span class="string">'CPU Temperature = '</span>+CPU_temp)</div><div class="line">    print(<span class="string">'CPU Use = '</span>+CPU_usage+<span class="string">' %'</span>)</div><div class="line">    print(<span class="string">'GPU Temperature = '</span>+ str(get_gpu_temp()))</div><div class="line">    print(<span class="string">''</span>)</div><div class="line">    print(<span class="string">'RAM Total = '</span>+str(RAM_total)+<span class="string">' MB'</span>)</div><div class="line">    print(<span class="string">'RAM Used = '</span>+str(RAM_used)+<span class="string">' MB'</span>)</div><div class="line">    print(<span class="string">'RAM Free = '</span>+str(RAM_free)+<span class="string">' MB'</span>)</div><div class="line">    print(<span class="string">''</span>) </div><div class="line">    print(<span class="string">'DISK Total Space = '</span>+str(DISK_total)+<span class="string">'B'</span>)</div><div class="line">    print(<span class="string">'DISK Used Space = '</span>+str(DISK_used)+<span class="string">'B'</span>)</div><div class="line">    print(<span class="string">'DISK Used Percentage = '</span>+str(DISK_perc))</div></pre></td></tr></table></figure></p>
<p>赋予脚本执行权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo chmod +x get.py</div></pre></td></tr></table></figure></p>
<p>最后执行脚本，这样就可以显示信息了，前提是装了python客户端。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python get.py</div></pre></td></tr></table></figure></p>





</body>
</html>